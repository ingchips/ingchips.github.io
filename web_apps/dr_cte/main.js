function inspect_cte(e,t,r){function n(e){var t="";try{t=window.atob(e)}catch{}for(var r=[],n=0;n<t.length;++n)r.push(t.charCodeAt(n));return r}function a(e){const t=Enumerable.from([-2*Math.PI,0,2*Math.PI]);e[0][1]=e[0][1].arg(),e[0][2]=e[0][1];for(var r=0,n=1;n<e.length;n++){var a=e[n][1].arg(),l=t.select(e=>a+r+e).minBy(t=>Math.abs(t-e[n-1][1]));e[n][1]=l,e[n][2]=a,r=l-a}}function l(e){return function(t){return t<=7?e[0]:e[math.mod(t-7,e.length)]}}function o(e){const t=Enumerable.from(e).select(e=>e[0]),r=Enumerable.from(e).select(e=>e[1]),n=t.average(),a=r.average(),l=t.select(e=>e-n).zip(r.select(e=>e-a),(e,t)=>e*t).sum()/t.select(e=>(e-n)*(e-n)).sum(),o=a-l*n;return e=>o+l*e}function s(e,t){let r=1==e.slot_durations?function(e){return e<=7?e:7+2*(e-7)}:function(e){return e<=7?e:7+4*(e-7)};var n=[];!function(e,t){let r=l(t);for(var n=[],a=0;a<t.length;a++){let l=t[a];const s=Enumerable.from(e.samples).where((e,t)=>r(t)==l);var o=s.aggregate(math.complex(0),(e,t)=>e.add(t));n[l]=o.div(s.count())}for(a=0;a<e.samples.length;a++)e.samples[a]=e.samples[a].sub(n[r(a)])}(e,t),function(e,t){let r=l(t);for(var n=[],a=0;a<t.length;a++){let l=t[a];const o=Enumerable.from(e.samples).where((e,t)=>r(t)==l).select(e=>Math.pow(e.abs(),2)).average();n[l]=Math.sqrt(8e3/o)}for(a=0;a<e.samples.length;a++)e.samples[a]=e.samples[a].mul(n[r(a)])}(e,t);for(var s=0;s<8;s++)n.push([s,e.samples[s]]);a(n);var u=o(n);for(s=0;s<e.samples.length;s++)e.samples[s]=e.samples[s].mul(math.complex({r:1,phi:-u(r(s))}));n=[];for(s=0;s<e.samples.length;s++){t[s>=8?(s-8+1)%t.length:0]==t[0]&&n.push([r(s),e.samples[s]])}a(n),u=o(n);for(s=0;s<e.samples.length;s++)e.samples[s]=e.samples[s].mul(math.complex({r:1,phi:-u(r(s))}))}var u=[];function c(e,t,r){return{x:e.select(e=>e.re).toArray(),y:e.select(e=>e.im).toArray(),mode:"markers",type:"scatter",name:r,marker:{color:t},text:e.select((e,t)=>"#"+t).toArray()}}var m={},i=[];function f(e){i.unshift("["+(new Date).toLocaleTimeString()+"] "+e),i.length>20&&i.pop(),$("#logview").text(i.join("\n"))}function p(e,t){let a=0==r?function(e){let t=[{t:"u16",n:"sync_handle"},{t:"u8",n:"rx_phy"},{t:"u8",n:"channel_index"},{t:"s16",n:"rssi"},{t:"u8",n:"rssi_ant_id"},{t:"u8",n:"cte_type"},{t:"u8",n:"slot_durations"},{t:"u8",n:"packet_status"},{t:"u16",n:"event_counter"},{t:"u8",n:"sample_count"},{t:"struct",n:"samples",len:"sample_count",fields:[{t:"s8",n:"re"},{t:"s8",n:"im"}]}];var r=null;try{var a=n(e);if(a.length<1)return null;r=parseSchema(t,a);var l=[];for(var o of r.samples)l.push(math.complex(o));r.samples=l}catch{}return r}(t):function(e){let t=[{t:"u16",n:"sync_handle"},{t:"u8",n:"channel_index"},{t:"s16",n:"rssi"},{t:"u8",n:"rssi_ant_id"},{t:"u8",n:"cte_type"},{t:"u8",n:"slot_durations"},{t:"u8",n:"packet_status"},{t:"u16",n:"event_counter"},{t:"u8",n:"sample_count"},{t:"struct",n:"samples",len:"sample_count",fields:[{t:"s8",n:"re"},{t:"s8",n:"im"}]}];var r=null;try{var a=n(e);if(a.length<1)return null;r=parseSchema(t,a);var l=[];for(var o of r.samples)l.push(math.complex(o));r.samples=l}catch{}return r}(t);if(null!=a){f(t);const e=u[0];!function(e,t,r,n){const a=["#D50000","#AA00FF","#304FFE","#00B8D4","#00C853","#AEEA00","#FFD600","#DD2C00"];let o=l(n),s=new Set(n);var u=[];{const e=Enumerable.from(r).where((e,t)=>t<=7),t=e.select(e=>e.re).toArray(),n=e.select(e=>e.im).toArray(),a=e.select((e,t)=>"#"+t).toArray();u.push({x:t,y:n,mode:"markers",type:"scatter",name:"ref",marker:{color:"gray"},text:a})}for(var c of s){const e=Enumerable.from(r).where((e,t)=>t>=8&&o(t)==c),t=Enumerable.from(r).select((e,t)=>"#"+t).where((e,t)=>t>=8&&o(t)==c).toArray(),n=e.select(e=>e.re).toArray(),l=e.select(e=>e.im).toArray();u.push({x:n,y:l,mode:"markers",type:"scatter",name:""+c,marker:{color:a[c]},text:t})}var m={xaxis:{range:[-127,127]},yaxis:{range:[-127,127]},title:t};Plotly.newPlot(e,u,m)}("plot_raw","Raw",a.samples,u);let r=[];s(a,u);const n=function(e,t){let r=l(t);const n=function(e){var t=[];for(var r of e)t.indexOf(r)>=0||t.push(r);return t}(t);var a={};for(var o of n)a[o]=Enumerable.from(e).where((e,t)=>r(t)==o).toArray();return a}(a.samples,u);let m=function(e){var t={};for(var r in e){var n=Enumerable.from(e[r]),a=n.aggregate(math.complex(0),(e,t)=>e.add(t)).div(n.count());const l=n.select(e=>Math.pow(e.sub(a).abs(),2)).average();t[r]=10*Math.log10(Math.pow(a.abs(),2)/l)}return t}(n);if(console.log(m),u.length>3)for(var o of r)delete n[o];!function(e,t,r,n){const a=["#D50000","#AA00FF","#304FFE","#00B8D4","#00C853","#AEEA00","#FFD600","#DD2C00"];var l=[];{const e=r[n];l.push(c(Enumerable.from(e).where((e,t)=>t<=7),"gray","ref")),l.push(c(Enumerable.from(e).where((e,t)=>t>7),a[n],n))}for(var o in r)o!=n&&l.push(c(Enumerable.from(r[o]),a[o],o));var s={xaxis:{range:[-127,127]},yaxis:{range:[-127,127]},title:t};Plotly.newPlot(e,l,s)}("plot_dem","Preprocess",n,e),function(e,t){$("#output_c").val(""),$("#output_matlab").val(""),$("#output_mma").val(""),$("#output_py").val(""),function(e,t,r){function n(e){return Enumerable.from(e).select(e=>e.re.toFixed(5)+v(e.im)+"j").toArray().join(", ")}g(e,"samples[ref] =");let a=n(t[r].slice(0,8));g(e,"["+h(a," ...")+"]\n");for(let a in t){g(e,"samples[{0}] =".format(a));let l=n(a!=r?t[a]:t[a].slice(8));g(e,"["+h(l," ...")+"]\n")}}("#output_matlab",e,t),function(e,t,r){function n(e){return Enumerable.from(e).select(e=>e.re.toFixed(5)+v(e.im)+"I").toArray().join(", ")}g(e,"samples[ref] =");let a=n(t[r].slice(0,8));g(e,"{"+h(a,"")+"}\n");for(let a in t){g(e,"samples[{0}] =".format(a));let l=n(a!=r?t[a]:t[a].slice(8));g(e,"{"+h(l,"")+"}\n")}}("#output_mma",e,t),function(e,t,r){function n(e){return Enumerable.from(e).select(e=>e.re.toFixed(5)+v(e.im)+"j").toArray().join(", ")}g(e,"samples[ref] =");let a=n(t[r].slice(0,8));g(e,"["+h(a," \\")+"]\n");for(let a in t){g(e,"samples[{0}] =".format(a));let l=n(a!=r?t[a]:t[a].slice(8));g(e,"["+h(l," \\")+"]\n")}}("#output_py",e,t),function(e,t,r){function n(e){return Enumerable.from(e).select(e=>"{"+e.re.toFixed(5)+","+v(e.im)+"}").toArray().join(", ")}g(e,"samples[ref] =");let a=n(t[r].slice(0,8));g(e,"{"+h(a,"","},")+"}\n");for(let a in t){g(e,"samples[{0}] =".format(a));let l=n(a!=r?t[a]:t[a].slice(8));g(e,"{"+h(l,"","},")+"}\n")}}("#output_c",e,t)}(n,e)}}function h(e,t,r){var n="",a=e;let l=void 0===r?",":r;for(;a.length>0;){let e=a.indexOf(l,80);e<0&&(e=a.length),n=n+t+"\n"+a.slice(0,e+l.length),a=a.slice(e+l.length)}return n.slice(t.length+1)}function v(e){return e>0?" + "+e.toFixed(5):" - "+(-e).toFixed(5)}function g(e,t){let r=$(e);r.val(r.val()+"\n"+t)}String.prototype.format=function(){var e=arguments;return this.replace(/\{(\d+)\}/g,function(t,r){return e[r]})},u=function(e){var t=[];for(var r of e.split(",")){let e=parseInt(r);isNaN(e)||t.push(e)}return t}(e),function(e,t){for(var r=(t=m[e]+t).split(/\r|\n/),n=0;n<r.length-1;n++)p(0,r[n]);m[e]=r[r.length-1]}(0,"\n"+t+"\n")}