<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- UIkit CSS -->
    <link rel="stylesheet" href="dist/css/uikit.min.css" />
    <title>SecBox Test App</title>
</head>
<body>
<!-- UIkit JS -->
<script src="dist/js/uikit.min.js"></script>
<script src="dist/js/uikit-icons.min.js"></script>

<script src="dist/js/jquery-3.5.1.min.js"></script>

<script src="dist/js/sm2.js"></script>
<script src="dist/js/sm3.js"></script>
<script src="dist/js/sm4.js"></script>
<script src="dist/js/structparser.js"></script>

<script src="msg.js"></script>
<script src="main.js"></script>
<script>

</script>

<div class="uk-container">

<div id="loader">
    <div class="uk-margin"> </div>

    <div id="api_notice" class="uk-alert-default" uk-alert>
        <h3><span uk-icon="warning"></span> Notice</h3>
        <p>APIs of file & bluetooth are not fully supported in this browser.</p>
        <p class="uk-text-danger">Web Platform features (see about://flags) are required, currently only available on Chromium based browsers.</p>
    </div>

    <div id="startup_window" class="uk-margin">
        <button id="btn_scan" class="uk-button uk-button-primary">Select</button>
    </div>

    <div id="main_window">

        <div class="uk-card uk-card-default uk-card-body uk-margin">
            <div class="uk-margin"></div>
            <form class="uk-form-horizontal">
                <div class="uk-margin">
                    <label class="uk-form-label" for="form-horizontal-text">MTU Size</label>
                    <div class="uk-form-controls">
                        <input class="uk-input" type="text" id="mtu_size" value="200"></input>
                        <a href="https://github.com/WebBluetoothCG/web-bluetooth/issues/383">More infomration</a> on why this
                        tool can't detect MTU.
                    </div>
                </div>

                <div class="uk-margin">
                    <label class="uk-form-label" for="form-horizontal-text">PKroot</label>
                    <div class="uk-form-controls">
                        <input class="uk-input" type="text" id="PKroot" value="04C17A6CDCF889FA37DF85EAA6AD209426077566B4CC0E7C1AA791756439ED33CAD834054643D4FD07835BF9BC276906E67E62D7A4B510B62DEBE29FAE4BC3F074"></input>
                    </div>
                </div>

                <div class="uk-margin">
                    <label class="uk-form-label" for="form-horizontal-text">SKroot</label>
                    <div class="uk-form-controls">
                        <input class="uk-input" type="text" id="SKroot" value="C61D870FBE02FE3D1E09A42797EF1063A3A8E9B77C1A7D73E69FD7AFFFB9317F"></input>
                    </div>
                </div>

                <div class="uk-margin">
                    <label class="uk-form-label" for="form-horizontal-text">PKcard</label>
                    <div class="uk-form-controls">
                        <input class="uk-input" type="text" id="PKcard" value="045585EC92F1C77350D848A38EF7EA69B9268C29300A9ED2D2EAC929FC12F3BE01B55DF9141725E9868DB121B4C54D229433B9084E0CE5CEA15D84998ED875B9EB"></input>
                    </div>
                </div>
            </form>

        </div>

        <div class="uk-card uk-card-default uk-card-body uk-margin">
            <div class="uk-card-header">
                <h3 class="uk-card-title uk-margin-remove-bottom">功能测试</h3>
            </div>

            <ul uk-tab>
                <li class="uk-active"><a href="#">基本功能</a></li>
                <li><a href="#">扩展功能</a></li>
                <li><a href="#">生成（个人化）</a></li>
            </ul>

            <ul class="uk-switcher uk-margin">
                <li class="uk-active">
                    <ul uk-tab>
                        <li class="uk-active"><a href="#">获取随机数</a></li>
                        <li><a href="#">SM2_GenKey</a></li>
                        <li><a href="#">SM2_ReadPubKey</a></li>
                        <li><a>SM2_Sign</a></li>
                        <li><a>SM2_ChipAuth</a></li>
                    </ul>

                    <ul class="uk-switcher uk-margin">
                        <li class="uk-active">
                            <div class="uk-margin"></div>
                            <form class="uk-form-horizontal">
                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">长度</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input"  type="text" id="random_size" value="8"></input>
                                    </div>
                                </div>
                            </form>
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="test_get_random(parseInt($('#random_size').val()))">测试</button>
                            </div>
                        </li>
                        <li>
                            <div class="uk-margin"></div>
                            <form class="uk-form-horizontal">
                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">密钥索引号</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="sm2_gen_kid" value="0"></input>
                                    </div>
                                </div>
                            </form>
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="test_sm2_gen(parseInt($('#sm2_gen_kid').val()))">测试</button>
                            </div>
                        </li>
                        <li>
                            <div class="uk-margin"></div>
                            <form class="uk-form-horizontal">
                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">密钥索引号</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="sm2_readpub_kid" value="0"></input>
                                    </div>
                                </div>
                            </form>
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="test_sm2_readpub(parseInt($('#sm2_readpub_kid').val()))">测试</button>
                            </div>
                        </li>
                        <li>
                            <div class="uk-margin"></div>
                            <form class="uk-form-horizontal">
                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">密钥索引号</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="sm2_sign_kid" value="0"></input>
                                    </div>
                                    <div class="uk-margin"></div>
                                    <label class="uk-form-label" for="form-horizontal-text">SM3 HASH</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="sm2_sign_hash" value="2000000000000000000000000000000000000000000000000000000000000000"></input>
                                    </div>
                                </div>
                            </form>
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="test_sm2_sign(parseInt($('#sm2_sign_kid').val()),$('#sm2_sign_hash').val())">测试</button>
                            </div>
                        </li>
                        <li>
                            <div class="uk-margin"></div>
                            <form class="uk-form-horizontal">
                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">随机数</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="chip_auth_rand" value="1000000000000000000000000000000000000000000000000000000000000000"></input>
                                    </div>
                                </div>
                            </form>
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="test_chip_auth($('#PKcard').val(), $('#chip_auth_rand').val())">测试</button>
                            </div>
                        </li>
                    </ul>
                </li>
                <li>
                    <ul uk-tab>
                        <li class="uk-active"><a href="#">系统信息</a></li>
                        <li><a href="#">系统指令校验</a></li>
                        <li><a href="#">系统程序升级</a></li>
                    </ul>

                    <ul class="uk-switcher uk-margin">
                        <li class="uk-active">
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="test_system_info()">测试</button>
                            </div>
                        </li>
                        <li>
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="test_sys_auth($('#PKcard').val(), $('#SKroot').val())">测试</button>
                            </div>
                        </li>
                        <li>
                            <div class="js-upload uk-placeholder uk-text-center" id="bin_file_drop_zone">
                                <span uk-icon="icon: cloud-upload"></span>
                                <span class="uk-text-middle">将 .bin 文件拖放到此处或者 </span>
                                <div uk-form-custom>
                                    <input type="file" id="bin_file_select"  accept="application/octet-stream"><span class="uk-link">选择一个文件</span>
                                </div>
                            </div>

                            <div class="uk-margin">
                                <progress id="ota-progressbar" class="uk-progress" value="0" max="100"></progress>
                            </div>

                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="test_ota_update($('#SKroot').val())">升级</button>
                            </div>

                        </li>
                    </ul>
                </li>
                <li>
                    <ul uk-tab>
                        <li class="uk-active"><a href="#">SKroot 签名</a></li>
                        <li><a href="#">验签</a></li>
                        <li><a href="#">Hash</a></li>
                    </ul>

                    <ul class="uk-switcher uk-margin">
                        <li class="uk-active">
                            <form class="uk-form-horizontal">
                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">SM3 Hash</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="prod_sig_data" value=""></input>
                                    </div>
                                </div>
                            </form>
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="btn_sm2_sign($('#SKroot').val(), $('#prod_sig_data').val())">签名</button>
                            </div>
                        </li>

                        <li>
                            <form class="uk-form-horizontal">
                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">SM3 Hash</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="prod_veri_sm3_hash" value=""></input>
                                    </div>
                                </div>

                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">签名</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="prod_veri_sig" value=""></input>
                                    </div>
                                </div>

                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">指定公钥</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="prod_veri_my_pk" value=""></input>
                                    </div>
                                </div>
                            </form>
                            <div class="uk-margin">
                                <button class="uk-button" onclick="btn_sm2_verify($('#PKroot').val(), $('#prod_veri_sm3_hash').val(), $('#prod_veri_sig').val())">PKroot 验签</button>
                                <button class="uk-button uk-button-primary" onclick="btn_sm2_verify($('#PKcard').val(), $('#prod_veri_sm3_hash').val(), $('#prod_veri_sig').val())">PKcard 验签</button>
                                <button class="uk-button uk-button-secondary" onclick="btn_sm2_verify($('#prod_veri_my_pk').val(), $('#prod_veri_sm3_hash').val(), $('#prod_veri_sig').val())">指定公钥验签</button>
                            </div>
                        </li>

                        <li>
                            <form class="uk-form-horizontal">
                                <div class="uk-margin">
                                    <label class="uk-form-label" for="form-horizontal-text">数据</label>
                                    <div class="uk-form-controls">
                                        <input class="uk-input" type="text" id="prod_sm3_data" value=""></input>
                                    </div>
                                </div>
                            </form>
                            <div class="uk-margin">
                                <button class="uk-button uk-button-primary" onclick="btn_gen_sm3($('#prod_sm3_data').val())">SM3</button>
                            </div>
                        </li>
                    </ul>

                </li>
            </ul>
            <textarea  id="output" class="uk-textarea" rows="10" style="font-family: consolas"></textarea>
        </div>
    </div>
</div>

    <div id="running_status">

        <div class="uk-card uk-card-default uk-card-body">
            <div class="uk-card-header">
                <h3 class="uk-card-title uk-margin-remove-bottom">Please wait ...</h3>
            </div>

            <div class="uk-margin uk-text-center">
                <div id="js-spinner"  uk-spinner="ratio: 2"></div>
            </div>

            <div class="uk-margin">
                <progress id="js-progressbar" class="uk-progress" value="0" max="100"></progress>
            </div>

            <div class="uk-margin">
                <div id="js-message" class="uk-text-meta uk-text-center">
                    burning platform.bin
                </div>
            </div>
            <hr>
        </div>
   </div>

</div>

</div>

</body>
</html>